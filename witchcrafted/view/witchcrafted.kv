#: kivy 2.1
#: import CardView witchcrafted.cards.card_view
#: import CardPanel witchcrafted.cards.card_panel
#: import CardEdit witchcrafted.cards.card_edit
#: import MainPanel witchcrafted.main_panel

<CardPanel>:
    cols: 1
    rows: 3
    id: card_panel
    image: image

    card_id: None
    card_image: None
    card_name: None

    on_release: app.select_for_edit(self.card_id)

    Label:
        size_hint_y: 0.1
        text: f"{card_panel.card_id}"
    Label:
        size_hint_y: 0.1
        text: f"{card_panel.card_name}" if card_panel.card_name is not None else "Loading"

    Image:
        id: image
        source: ""
        texture: card_panel.card_image.texture if card_panel.card_image is not None else card_panel.card_image


MainPanel:
    id: main_panel
    size_hint: 1., 1.
    pos_hint: {'center_x': .5, 'center_y': .5}
    do_default_tab: False

    selected_card_id: None
    card_view_tab: card_view_tab
    card_edit_tab: card_edit_tab

    TabbedPanelItem:
        id: card_view_tab
        text: 'Card Pool'
        CardView:
            id: card_view
            on_scroll_y: self.scroll_data()
            viewclass: 'CardPanel'

            card_grid: card_grid
            num_of_cards: 0
            num_of_columns: 4
            num_of_rows: 4

            RecycleGridLayout:
                id: card_grid
                cols: card_view.num_of_columns
                size_hint_y: None
                height: self.minimum_height
                default_size_hint: 1, None
                default_size: 1, 400

    TabbedPanelItem:
        id: card_edit_tab
        text: 'Edit Card'
        CardEdit:
            id: card_edit

            cols: 1
            rows: 3

            card_id: app.selected_card_id
            card_image: None
            card_name: None

            Label:
                size_hint: 1., 0.1
                text: f"Editing {card_edit.card_id}: {card_edit.card_name}"

    TabbedPanelItem:
        text: 'Settings'
        on_release: app.panel_settings()
        # Button:
        #     text: 'App Settings'
        #     on_release: app.open_settings()
